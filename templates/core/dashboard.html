{% extends 'base.html' %}

{% block title %}Bosh sahifa - IELTS Center{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Welcome section -->
    <div class="row mb-4 fade-in-up">
        <div class="col-12">
            <div class="card border-0 dashboard-welcome" style="position: relative; overflow: hidden;">
                <div class="card-body dashboard-welcome-content">
                    <div class="d-flex justify-content-between align-items-center flex-wrap">
                        <div class="fade-in-left">
                            <h1 class="dashboard-welcome-title gradient-text" style="background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.9) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">{{ user.first_name|default:user.username }}! ðŸ‘‹</h1>
                            <p class="dashboard-welcome-subtitle mb-0">Bugun nima o'rganamiz?</p>
                        </div>
                        <div class="text-end fade-in-right" style="margin-top: 1rem;">
                            <div class="dashboard-stats-card glass pulse-animation">
                                <div class="dashboard-stats-label">O'rtacha ball</div>
                                <div class="dashboard-stats-value">{{ user_stats.average_score|floatformat:0 }}%</div>
                                <div class="progress mt-3" style="height: 6px; background: rgba(255,255,255,0.3); border-radius: 10px; overflow: hidden;">
                                    <div class="progress-bar progress-bar-animated" style="width: {{ user_stats.average_score }}%; background: white; border-radius: 10px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Animated background elements -->
                <div style="position: absolute; top: -50%; right: -20%; width: 400px; height: 400px; background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%); border-radius: 50%; animation: float 6s ease-in-out infinite; pointer-events: none;"></div>
                <div style="position: absolute; bottom: -30%; left: -10%; width: 300px; height: 300px; background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%); border-radius: 50%; animation: float 8s ease-in-out infinite reverse; pointer-events: none;"></div>
                <div style="position: absolute; top: 20%; right: 10%; width: 200px; height: 200px; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); border-radius: 50%; animation: float 10s ease-in-out infinite; pointer-events: none;"></div>
            </div>
        </div>
    </div>

    <!-- Statistika kartalari -->
    <div class="row mb-5">
        <div class="col-12 col-sm-6 col-md-3 mb-4 stagger-item">
            <div class="stat-card stat-card-primary hover-lift">
                <div class="d-flex justify-content-between align-items-center">
                    <div style="position: relative; z-index: 1;">
                        <p class="stat-card-label">Ishlangan testlar</p>
                        <h3 class="stat-card-value gradient-text" style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">{{ user_stats.tests_completed }}</h3>
                        <p class="text-muted mb-0" style="font-size: 0.875rem; font-weight: 600;">Jami: {{ total_tests }} test</p>
                    </div>
                    <div style="position: relative; z-index: 1;">
                        <i class="fas fa-clipboard-list fa-3x" style="color: var(--primary); opacity: 0.15; animation: float 4s ease-in-out infinite;"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4 stagger-item">
            <div class="stat-card stat-card-success hover-lift">
                <div class="d-flex justify-content-between align-items-center">
                    <div style="position: relative; z-index: 1;">
                        <p class="stat-card-label">Ko'rilgan videolar</p>
                        <h3 class="stat-card-value gradient-text" style="background: linear-gradient(135deg, var(--success) 0%, #34d399 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">{{ user_stats.videos_watched }}</h3>
                        <p class="text-muted mb-0" style="font-size: 0.875rem; font-weight: 600;">Jami: {{ total_videos }} video</p>
                    </div>
                    <div style="position: relative; z-index: 1;">
                        <i class="fas fa-video fa-3x" style="color: var(--success); opacity: 0.15; animation: float 4s ease-in-out infinite 0.5s;"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4 stagger-item">
            <div class="stat-card stat-card-info hover-lift">
                <div class="d-flex justify-content-between align-items-center">
                    <div style="position: relative; z-index: 1;">
                        <p class="stat-card-label">O'rtacha ball</p>
                        <h3 class="stat-card-value gradient-text" style="background: linear-gradient(135deg, var(--info) 0%, #0891b2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">{{ user_stats.average_score|floatformat:1 }}%</h3>
                        <div class="mt-3">
                            <div class="progress" style="height: 8px; background: var(--gray-200); border-radius: 10px; overflow: hidden;">
                                <div class="progress-bar progress-bar-animated" style="width: {{ user_stats.average_score }}%; background: linear-gradient(90deg, var(--info) 0%, #0891b2 100%); border-radius: 10px;"></div>
                            </div>
                        </div>
                    </div>
                    <div style="position: relative; z-index: 1;">
                        <i class="fas fa-chart-line fa-3x" style="color: var(--info); opacity: 0.15; animation: float 4s ease-in-out infinite 1s;"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4 stagger-item">
            <div class="stat-card stat-card-warning hover-lift">
                <div class="d-flex justify-content-between align-items-center">
                    <div style="position: relative; z-index: 1;">
                        <p class="stat-card-label">Study Streak</p>
                        <h3 class="stat-card-value gradient-text" style="background: linear-gradient(135deg, var(--warning) 0%, #fbbf24 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">{{ user_stats.current_streak }}</h3>
                        <p class="text-muted mb-0" style="font-size: 0.875rem; font-weight: 600;">kun ketma-ket ðŸ”¥</p>
                    </div>
                    <div style="position: relative; z-index: 1;">
                        <i class="fas fa-fire fa-3x" style="color: var(--warning); opacity: 0.15; animation: bounce 2s ease-in-out infinite;"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick links -->
    <div class="row mb-5">
        <div class="col-12 col-md-4 mb-3 stagger-item">
            <a href="{% url 'core:leaderboard' %}" class="card text-decoration-none quick-link-card hover-lift">
                <div class="card-body text-center p-4">
                    <div class="quick-link-icon scale-in" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); box-shadow: 0 8px 24px rgba(245, 158, 11, 0.4);">
                        <i class="fas fa-trophy fa-2x text-white bounce-animation"></i>
                    </div>
                    <h5 class="mb-2 gradient-text" style="font-weight: 700; font-size: 1.25rem;">Reyting</h5>
                    <p class="text-muted mb-0" style="font-size: 0.875rem;">Eng yaxshi natijalar</p>
                </div>
            </a>
        </div>
        <div class="col-md-4 mb-3 stagger-item">
            <a href="{% url 'core:statistics' %}" class="card text-decoration-none quick-link-card hover-lift">
                <div class="card-body text-center p-4">
                    <div class="quick-link-icon scale-in" style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); box-shadow: 0 8px 24px rgba(37, 99, 235, 0.4);">
                        <i class="fas fa-chart-bar fa-2x text-white bounce-animation"></i>
                    </div>
                    <h5 class="mb-2 gradient-text" style="font-weight: 700; font-size: 1.25rem;">Statistika</h5>
                    <p class="text-muted mb-0" style="font-size: 0.875rem;">Batafsil tahlillar</p>
                </div>
            </a>
        </div>
        <div class="col-md-4 mb-3 stagger-item">
            <a href="{% url 'core:profile' %}" class="card text-decoration-none quick-link-card hover-lift">
                <div class="card-body text-center p-4">
                    <div class="quick-link-icon scale-in" style="background: linear-gradient(135deg, var(--success) 0%, #059669 100%); box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);">
                        <i class="fas fa-user fa-2x text-white bounce-animation"></i>
                    </div>
                    <h5 class="mb-2 gradient-text" style="font-weight: 700; font-size: 1.25rem;">Profil</h5>
                    <p class="text-muted mb-0" style="font-size: 0.875rem;">Shaxsiy ma'lumotlar</p>
                </div>
            </a>
        </div>
    </div>

    <!-- Kategoriyalar -->
    <div class="row mb-4 fade-in-down">
        <div class="col-12 mb-4">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <h2 class="mb-0 gradient-text" style="font-weight: 800; font-size: 2.5rem;">Kategoriyalar</h2>
                <div class="mt-2 mt-md-0">
                    <a href="{% url 'core:video_list' %}" class="btn btn-primary btn-sm me-2 hover-lift">
                        <i class="fas fa-video me-1"></i>Barcha videolar
                    </a>
                    <a href="{% url 'core:test_list' %}" class="btn btn-outline-primary btn-sm hover-lift">
                        <i class="fas fa-clipboard-list me-1"></i>Barcha testlar
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        {% for category in categories %}
        <div class="col-12 col-sm-6 col-md-4 mb-4 stagger-item">
            <div class="category-card hover-lift">
                <div class="category-icon-large scale-in" style="background: linear-gradient(135deg, {{ category.color }}20 0%, {{ category.color }}10 100%); border: 2px solid {{ category.color }}30; box-shadow: 0 4px 16px {{ category.color }}30;">
                    {% if category.icon %}
                    <i class="{{ category.icon }}" style="color: {{ category.color }}; filter: drop-shadow(0 2px 4px {{ category.color }}40);"></i>
                    {% else %}
                    <i class="fas fa-folder" style="color: {{ category.color }}; filter: drop-shadow(0 2px 4px {{ category.color }}40);"></i>
                    {% endif %}
                </div>
                <h4 class="mb-3 gradient-text" style="font-weight: 700; font-size: 1.5rem;">{{ category.name }}</h4>
                {% if category.description %}
                <p class="text-muted mb-4" style="font-size: 0.9375rem; line-height: 1.7; min-height: 70px;">{{ category.description|truncatewords:20 }}</p>
                {% endif %}
                <div class="d-grid gap-2 mt-auto">
                    <a href="{% url 'core:video_list' %}?category={{ category.slug }}" class="btn btn-primary hover-lift">
                        <i class="fas fa-video me-2"></i>Videolar
                    </a>
                    <a href="{% url 'core:test_list' %}?category={{ category.slug }}" class="btn btn-outline-primary hover-lift">
                        <i class="fas fa-clipboard-list me-2"></i>Testlar
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center py-5">
                    <i class="fas fa-folder-open fa-4x text-muted mb-4 pulse-animation" style="opacity: 0.3;"></i>
                    <h5 class="text-muted mb-2">Hozircha kategoriyalar mavjud emas</h5>
                    <p class="text-muted mb-0">Admin panel orqali kategoriyalar qo'shing</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
